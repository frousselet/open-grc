# Generated by Django 6.0.2 on 2026-02-27 13:48

import django.db.models.deletion
import simple_history.models
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('assets', '0004_rename_version_add_version'),
        ('context', '0003_add_version_remove_scope_version'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Framework',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(max_length=50, unique=True, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('short_name', models.CharField(blank=True, default='', max_length=50, verbose_name='Abréviation')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('type', models.CharField(choices=[('standard', 'Norme'), ('law', 'Loi'), ('regulation', 'Règlement'), ('contract', 'Contrat'), ('internal_policy', 'Politique interne'), ('industry_framework', 'Référentiel sectoriel'), ('other', 'Autre')], max_length=30, verbose_name='Type')),
                ('category', models.CharField(choices=[('information_security', "Sécurité de l'information"), ('privacy', 'Protection des données'), ('risk_management', 'Gestion des risques'), ('business_continuity', "Continuité d'activité"), ('cloud_security', 'Sécurité cloud'), ('sector_specific', 'Réglementations sectorielles'), ('it_governance', 'Gouvernance IT'), ('quality', 'Qualité'), ('contractual', 'Exigences contractuelles'), ('internal', 'Politiques internes'), ('other', 'Autre')], max_length=30, verbose_name='Catégorie')),
                ('framework_version', models.CharField(blank=True, default='', max_length=50, verbose_name='Version du référentiel')),
                ('publication_date', models.DateField(blank=True, null=True, verbose_name='Date de publication')),
                ('effective_date', models.DateField(blank=True, null=True, verbose_name="Date d'entrée en vigueur")),
                ('expiry_date', models.DateField(blank=True, null=True, verbose_name="Date d'expiration")),
                ('issuing_body', models.CharField(blank=True, default='', max_length=255, verbose_name='Organisme émetteur')),
                ('jurisdiction', models.CharField(blank=True, default='', max_length=255, verbose_name='Juridiction')),
                ('url', models.URLField(blank=True, default='', max_length=500, verbose_name='Lien officiel')),
                ('is_mandatory', models.BooleanField(default=False, verbose_name='Obligatoire')),
                ('is_applicable', models.BooleanField(default=True, verbose_name='Applicable')),
                ('applicability_justification', models.TextField(blank=True, default='', verbose_name="Justification d'applicabilité")),
                ('compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité (%)')),
                ('last_assessment_date', models.DateField(blank=True, null=True, verbose_name='Dernière évaluation')),
                ('status', models.CharField(choices=[('draft', 'Brouillon'), ('active', 'Actif'), ('under_review', 'En cours de revue'), ('deprecated', 'Obsolète'), ('archived', 'Archivé')], default='draft', max_length=20, verbose_name='Statut')),
                ('review_date', models.DateField(blank=True, null=True, verbose_name='Prochaine date de revue')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_approved', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='owned_frameworks', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('related_stakeholders', models.ManyToManyField(blank=True, related_name='related_frameworks', to='context.stakeholder', verbose_name='Parties intéressées')),
                ('scope', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_set', to='context.scope', verbose_name='Périmètre')),
            ],
            options={
                'verbose_name': 'Référentiel',
                'verbose_name_plural': 'Référentiels',
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='ComplianceAssessment',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('assessment_date', models.DateField(verbose_name='Date de réalisation')),
                ('methodology', models.TextField(blank=True, default='', verbose_name='Méthodologie')),
                ('overall_compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité global (%)')),
                ('total_requirements', models.PositiveIntegerField(default=0, verbose_name='Total exigences applicables')),
                ('compliant_count', models.PositiveIntegerField(default=0, verbose_name='Conformes')),
                ('partially_compliant_count', models.PositiveIntegerField(default=0, verbose_name='Partiellement conformes')),
                ('non_compliant_count', models.PositiveIntegerField(default=0, verbose_name='Non conformes')),
                ('not_assessed_count', models.PositiveIntegerField(default=0, verbose_name='Non évaluées')),
                ('status', models.CharField(choices=[('draft', 'Brouillon'), ('in_progress', 'En cours'), ('completed', 'Terminé'), ('validated', 'Validé'), ('archived', 'Archivé')], default='draft', max_length=20, verbose_name='Statut')),
                ('validated_at', models.DateTimeField(blank=True, null=True, verbose_name='Date de validation')),
                ('review_date', models.DateField(blank=True, null=True, verbose_name='Prochaine date de revue')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_approved', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('assessor', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='led_assessments', to=settings.AUTH_USER_MODEL, verbose_name='Évaluateur principal')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('scope', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_set', to='context.scope', verbose_name='Périmètre')),
                ('validated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='validated_assessments', to=settings.AUTH_USER_MODEL, verbose_name='Validé par')),
                ('framework', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='compliance.framework', verbose_name='Référentiel')),
            ],
            options={
                'verbose_name': 'Évaluation de conformité',
                'verbose_name_plural': 'Évaluations de conformité',
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='HistoricalComplianceAssessment',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('assessment_date', models.DateField(verbose_name='Date de réalisation')),
                ('methodology', models.TextField(blank=True, default='', verbose_name='Méthodologie')),
                ('overall_compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité global (%)')),
                ('total_requirements', models.PositiveIntegerField(default=0, verbose_name='Total exigences applicables')),
                ('compliant_count', models.PositiveIntegerField(default=0, verbose_name='Conformes')),
                ('partially_compliant_count', models.PositiveIntegerField(default=0, verbose_name='Partiellement conformes')),
                ('non_compliant_count', models.PositiveIntegerField(default=0, verbose_name='Non conformes')),
                ('not_assessed_count', models.PositiveIntegerField(default=0, verbose_name='Non évaluées')),
                ('status', models.CharField(choices=[('draft', 'Brouillon'), ('in_progress', 'En cours'), ('completed', 'Terminé'), ('validated', 'Validé'), ('archived', 'Archivé')], default='draft', max_length=20, verbose_name='Statut')),
                ('validated_at', models.DateTimeField(blank=True, null=True, verbose_name='Date de validation')),
                ('review_date', models.DateField(blank=True, null=True, verbose_name='Prochaine date de revue')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('assessor', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Évaluateur principal')),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('framework', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.framework', verbose_name='Référentiel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('scope', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='context.scope', verbose_name='Périmètre')),
                ('validated_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Validé par')),
            ],
            options={
                'verbose_name': 'historical Évaluation de conformité',
                'verbose_name_plural': 'historical Évaluations de conformité',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalFramework',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(db_index=True, max_length=50, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('short_name', models.CharField(blank=True, default='', max_length=50, verbose_name='Abréviation')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('type', models.CharField(choices=[('standard', 'Norme'), ('law', 'Loi'), ('regulation', 'Règlement'), ('contract', 'Contrat'), ('internal_policy', 'Politique interne'), ('industry_framework', 'Référentiel sectoriel'), ('other', 'Autre')], max_length=30, verbose_name='Type')),
                ('category', models.CharField(choices=[('information_security', "Sécurité de l'information"), ('privacy', 'Protection des données'), ('risk_management', 'Gestion des risques'), ('business_continuity', "Continuité d'activité"), ('cloud_security', 'Sécurité cloud'), ('sector_specific', 'Réglementations sectorielles'), ('it_governance', 'Gouvernance IT'), ('quality', 'Qualité'), ('contractual', 'Exigences contractuelles'), ('internal', 'Politiques internes'), ('other', 'Autre')], max_length=30, verbose_name='Catégorie')),
                ('framework_version', models.CharField(blank=True, default='', max_length=50, verbose_name='Version du référentiel')),
                ('publication_date', models.DateField(blank=True, null=True, verbose_name='Date de publication')),
                ('effective_date', models.DateField(blank=True, null=True, verbose_name="Date d'entrée en vigueur")),
                ('expiry_date', models.DateField(blank=True, null=True, verbose_name="Date d'expiration")),
                ('issuing_body', models.CharField(blank=True, default='', max_length=255, verbose_name='Organisme émetteur')),
                ('jurisdiction', models.CharField(blank=True, default='', max_length=255, verbose_name='Juridiction')),
                ('url', models.URLField(blank=True, default='', max_length=500, verbose_name='Lien officiel')),
                ('is_mandatory', models.BooleanField(default=False, verbose_name='Obligatoire')),
                ('is_applicable', models.BooleanField(default=True, verbose_name='Applicable')),
                ('applicability_justification', models.TextField(blank=True, default='', verbose_name="Justification d'applicabilité")),
                ('compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité (%)')),
                ('last_assessment_date', models.DateField(blank=True, null=True, verbose_name='Dernière évaluation')),
                ('status', models.CharField(choices=[('draft', 'Brouillon'), ('active', 'Actif'), ('under_review', 'En cours de revue'), ('deprecated', 'Obsolète'), ('archived', 'Archivé')], default='draft', max_length=20, verbose_name='Statut')),
                ('review_date', models.DateField(blank=True, null=True, verbose_name='Prochaine date de revue')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('owner', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('scope', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='context.scope', verbose_name='Périmètre')),
            ],
            options={
                'verbose_name': 'historical Référentiel',
                'verbose_name_plural': 'historical Référentiels',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='Requirement',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(max_length=100, verbose_name='Référence')),
                ('name', models.CharField(max_length=500, verbose_name='Intitulé')),
                ('description', models.TextField(verbose_name='Description')),
                ('guidance', models.TextField(blank=True, default='', verbose_name='Recommandations de mise en œuvre')),
                ('type', models.CharField(choices=[('mandatory', 'Obligatoire'), ('recommended', 'Recommandé'), ('optional', 'Optionnel')], max_length=20, verbose_name='Type')),
                ('category', models.CharField(blank=True, choices=[('organizational', 'Organisationnel'), ('technical', 'Technique'), ('physical', 'Physique'), ('legal', 'Juridique'), ('human', 'Humain'), ('other', 'Autre')], default='', max_length=20, verbose_name='Catégorie')),
                ('is_applicable', models.BooleanField(default=True, verbose_name='Applicable')),
                ('applicability_justification', models.TextField(blank=True, default='', verbose_name="Justification d'applicabilité")),
                ('compliance_status', models.CharField(choices=[('not_assessed', 'Non évalué'), ('non_compliant', 'Non conforme'), ('partially_compliant', 'Partiellement conforme'), ('compliant', 'Conforme'), ('not_applicable', 'Non applicable')], default='not_assessed', max_length=25, verbose_name='Statut de conformité')),
                ('compliance_level', models.PositiveIntegerField(default=0, verbose_name='Niveau de conformité (%)')),
                ('compliance_evidence', models.TextField(blank=True, default='', verbose_name='Preuves de conformité')),
                ('compliance_gaps', models.TextField(blank=True, default='', verbose_name='Écarts constatés')),
                ('last_assessment_date', models.DateField(blank=True, null=True, verbose_name='Dernière évaluation')),
                ('priority', models.CharField(blank=True, choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], default='', max_length=20, verbose_name='Priorité')),
                ('target_date', models.DateField(blank=True, null=True, verbose_name='Date cible')),
                ('order', models.PositiveIntegerField(default=0, verbose_name='Ordre')),
                ('status', models.CharField(choices=[('active', 'Actif'), ('deprecated', 'Obsolète'), ('superseded', 'Remplacé')], default='active', max_length=20, verbose_name='Statut')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_approved', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('framework', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='requirements', to='compliance.framework', verbose_name='Référentiel')),
                ('last_assessed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assessed_requirements', to=settings.AUTH_USER_MODEL, verbose_name='Dernier évaluateur')),
                ('linked_assets', models.ManyToManyField(blank=True, related_name='linked_requirements', to='assets.essentialasset', verbose_name='Biens essentiels liés')),
                ('linked_stakeholder_expectations', models.ManyToManyField(blank=True, related_name='linked_requirements', to='context.stakeholderexpectation', verbose_name='Attentes de PI liées')),
                ('owner', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='owned_requirements', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('scope', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_set', to='context.scope', verbose_name='Périmètre')),
            ],
            options={
                'verbose_name': 'Exigence',
                'verbose_name_plural': 'Exigences',
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='HistoricalRequirementMapping',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('mapping_type', models.CharField(choices=[('equivalent', 'Équivalent'), ('partial_overlap', 'Recouvrement partiel'), ('includes', 'Inclut'), ('included_by', 'Inclus par'), ('related', 'Lié')], max_length=20, verbose_name='Type de mapping')),
                ('coverage_level', models.CharField(blank=True, choices=[('full', 'Complète'), ('partial', 'Partielle'), ('minimal', 'Minimale')], default='', max_length=10, verbose_name='Niveau de couverture')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('justification', models.TextField(blank=True, default='', verbose_name='Justification')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('source_requirement', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.requirement', verbose_name='Exigence source')),
                ('target_requirement', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.requirement', verbose_name='Exigence cible')),
            ],
            options={
                'verbose_name': 'historical Mapping inter-référentiels',
                'verbose_name_plural': 'historical Mappings inter-référentiels',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalComplianceActionPlan',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(db_index=True, max_length=50, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('gap_description', models.TextField(verbose_name="Description de l'écart")),
                ('remediation_plan', models.TextField(verbose_name='Plan de remédiation')),
                ('priority', models.CharField(choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], max_length=20, verbose_name='Priorité')),
                ('start_date', models.DateField(blank=True, null=True, verbose_name='Date de début')),
                ('target_date', models.DateField(verbose_name='Date cible')),
                ('completion_date', models.DateField(blank=True, null=True, verbose_name="Date d'achèvement")),
                ('progress_percentage', models.PositiveIntegerField(default=0, verbose_name='Avancement (%)')),
                ('cost_estimate', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Estimation du coût')),
                ('status', models.CharField(choices=[('planned', 'Planifié'), ('in_progress', 'En cours'), ('completed', 'Terminé'), ('cancelled', 'Annulé'), ('overdue', 'En retard')], default='planned', max_length=20, verbose_name='Statut')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('assessment', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.complianceassessment', verbose_name='Évaluation source')),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('owner', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('scope', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='context.scope', verbose_name='Périmètre')),
                ('requirement', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.requirement', verbose_name='Exigence concernée')),
            ],
            options={
                'verbose_name': "historical Plan d'action de conformité",
                'verbose_name_plural': "historical Plans d'action de conformité",
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalAssessmentResult',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('compliance_status', models.CharField(choices=[('not_assessed', 'Non évalué'), ('non_compliant', 'Non conforme'), ('partially_compliant', 'Partiellement conforme'), ('compliant', 'Conforme'), ('not_applicable', 'Non applicable')], default='not_assessed', max_length=25, verbose_name='Statut de conformité')),
                ('compliance_level', models.PositiveIntegerField(default=0, verbose_name='Niveau de conformité (%)')),
                ('evidence', models.TextField(blank=True, default='', verbose_name='Preuves')),
                ('gaps', models.TextField(blank=True, default='', verbose_name='Écarts')),
                ('observations', models.TextField(blank=True, default='', verbose_name='Observations')),
                ('assessed_at', models.DateTimeField(verbose_name="Date d'évaluation")),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('assessed_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Évaluateur')),
                ('assessment', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.complianceassessment', verbose_name='Évaluation')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('requirement', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.requirement', verbose_name='Exigence')),
            ],
            options={
                'verbose_name': "historical Résultat d'évaluation",
                'verbose_name_plural': "historical Résultats d'évaluation",
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='ComplianceActionPlan',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(max_length=50, unique=True, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('gap_description', models.TextField(verbose_name="Description de l'écart")),
                ('remediation_plan', models.TextField(verbose_name='Plan de remédiation')),
                ('priority', models.CharField(choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], max_length=20, verbose_name='Priorité')),
                ('start_date', models.DateField(blank=True, null=True, verbose_name='Date de début')),
                ('target_date', models.DateField(verbose_name='Date cible')),
                ('completion_date', models.DateField(blank=True, null=True, verbose_name="Date d'achèvement")),
                ('progress_percentage', models.PositiveIntegerField(default=0, verbose_name='Avancement (%)')),
                ('cost_estimate', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True, verbose_name='Estimation du coût')),
                ('status', models.CharField(choices=[('planned', 'Planifié'), ('in_progress', 'En cours'), ('completed', 'Terminé'), ('cancelled', 'Annulé'), ('overdue', 'En retard')], default='planned', max_length=20, verbose_name='Statut')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_approved', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='owned_action_plans', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('scope', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='%(class)s_set', to='context.scope', verbose_name='Périmètre')),
                ('assessment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='action_plans', to='compliance.complianceassessment', verbose_name='Évaluation source')),
                ('requirement', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='action_plans', to='compliance.requirement', verbose_name='Exigence concernée')),
            ],
            options={
                'verbose_name': "Plan d'action de conformité",
                'verbose_name_plural': "Plans d'action de conformité",
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='Section',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('reference', models.CharField(max_length=50, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('order', models.PositiveIntegerField(default=0, verbose_name='Ordre')),
                ('compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité (%)')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('framework', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='sections', to='compliance.framework', verbose_name='Référentiel')),
                ('parent_section', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='compliance.section', verbose_name='Section parente')),
            ],
            options={
                'verbose_name': 'Section',
                'verbose_name_plural': 'Sections',
                'ordering': ['order'],
            },
        ),
        migrations.AddField(
            model_name='requirement',
            name='section',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='requirements', to='compliance.section', verbose_name='Section'),
        ),
        migrations.CreateModel(
            name='HistoricalSection',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('reference', models.CharField(max_length=50, verbose_name='Référence')),
                ('name', models.CharField(max_length=255, verbose_name='Nom')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('order', models.PositiveIntegerField(default=0, verbose_name='Ordre')),
                ('compliance_level', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='Niveau de conformité (%)')),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('framework', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.framework', verbose_name='Référentiel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('parent_section', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.section', verbose_name='Section parente')),
            ],
            options={
                'verbose_name': 'historical Section',
                'verbose_name_plural': 'historical Sections',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalRequirement',
            fields=[
                ('id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False)),
                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Date de modification')),
                ('is_approved', models.BooleanField(default=True, verbose_name='Approuvé')),
                ('approved_at', models.DateTimeField(blank=True, null=True, verbose_name="Date d'approbation")),
                ('version', models.PositiveIntegerField(default=1, verbose_name='Version')),
                ('reference', models.CharField(max_length=100, verbose_name='Référence')),
                ('name', models.CharField(max_length=500, verbose_name='Intitulé')),
                ('description', models.TextField(verbose_name='Description')),
                ('guidance', models.TextField(blank=True, default='', verbose_name='Recommandations de mise en œuvre')),
                ('type', models.CharField(choices=[('mandatory', 'Obligatoire'), ('recommended', 'Recommandé'), ('optional', 'Optionnel')], max_length=20, verbose_name='Type')),
                ('category', models.CharField(blank=True, choices=[('organizational', 'Organisationnel'), ('technical', 'Technique'), ('physical', 'Physique'), ('legal', 'Juridique'), ('human', 'Humain'), ('other', 'Autre')], default='', max_length=20, verbose_name='Catégorie')),
                ('is_applicable', models.BooleanField(default=True, verbose_name='Applicable')),
                ('applicability_justification', models.TextField(blank=True, default='', verbose_name="Justification d'applicabilité")),
                ('compliance_status', models.CharField(choices=[('not_assessed', 'Non évalué'), ('non_compliant', 'Non conforme'), ('partially_compliant', 'Partiellement conforme'), ('compliant', 'Conforme'), ('not_applicable', 'Non applicable')], default='not_assessed', max_length=25, verbose_name='Statut de conformité')),
                ('compliance_level', models.PositiveIntegerField(default=0, verbose_name='Niveau de conformité (%)')),
                ('compliance_evidence', models.TextField(blank=True, default='', verbose_name='Preuves de conformité')),
                ('compliance_gaps', models.TextField(blank=True, default='', verbose_name='Écarts constatés')),
                ('last_assessment_date', models.DateField(blank=True, null=True, verbose_name='Dernière évaluation')),
                ('priority', models.CharField(blank=True, choices=[('low', 'Faible'), ('medium', 'Moyen'), ('high', 'Élevé'), ('critical', 'Critique')], default='', max_length=20, verbose_name='Priorité')),
                ('target_date', models.DateField(blank=True, null=True, verbose_name='Date cible')),
                ('order', models.PositiveIntegerField(default=0, verbose_name='Ordre')),
                ('status', models.CharField(choices=[('active', 'Actif'), ('deprecated', 'Obsolète'), ('superseded', 'Remplacé')], default='active', max_length=20, verbose_name='Statut')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Approuvé par')),
                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('framework', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.framework', verbose_name='Référentiel')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('last_assessed_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Dernier évaluateur')),
                ('owner', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Responsable')),
                ('scope', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='context.scope', verbose_name='Périmètre')),
                ('section', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='compliance.section', verbose_name='Section')),
            ],
            options={
                'verbose_name': 'historical Exigence',
                'verbose_name_plural': 'historical Exigences',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='AssessmentResult',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('compliance_status', models.CharField(choices=[('not_assessed', 'Non évalué'), ('non_compliant', 'Non conforme'), ('partially_compliant', 'Partiellement conforme'), ('compliant', 'Conforme'), ('not_applicable', 'Non applicable')], default='not_assessed', max_length=25, verbose_name='Statut de conformité')),
                ('compliance_level', models.PositiveIntegerField(default=0, verbose_name='Niveau de conformité (%)')),
                ('evidence', models.TextField(blank=True, default='', verbose_name='Preuves')),
                ('gaps', models.TextField(blank=True, default='', verbose_name='Écarts')),
                ('observations', models.TextField(blank=True, default='', verbose_name='Observations')),
                ('assessed_at', models.DateTimeField(verbose_name="Date d'évaluation")),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('assessed_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='assessment_results', to=settings.AUTH_USER_MODEL, verbose_name='Évaluateur')),
                ('assessment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='results', to='compliance.complianceassessment', verbose_name='Évaluation')),
                ('requirement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessment_results', to='compliance.requirement', verbose_name='Exigence')),
            ],
            options={
                'verbose_name': "Résultat d'évaluation",
                'verbose_name_plural': "Résultats d'évaluation",
                'ordering': ['requirement__order'],
                'constraints': [models.UniqueConstraint(fields=('assessment', 'requirement'), name='unique_result_per_assessment_requirement')],
            },
        ),
        migrations.CreateModel(
            name='RequirementMapping',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('mapping_type', models.CharField(choices=[('equivalent', 'Équivalent'), ('partial_overlap', 'Recouvrement partiel'), ('includes', 'Inclut'), ('included_by', 'Inclus par'), ('related', 'Lié')], max_length=20, verbose_name='Type de mapping')),
                ('coverage_level', models.CharField(blank=True, choices=[('full', 'Complète'), ('partial', 'Partielle'), ('minimal', 'Minimale')], default='', max_length=10, verbose_name='Niveau de couverture')),
                ('description', models.TextField(blank=True, default='', verbose_name='Description')),
                ('justification', models.TextField(blank=True, default='', verbose_name='Justification')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Date de modification')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_mappings', to=settings.AUTH_USER_MODEL, verbose_name='Créé par')),
                ('source_requirement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mappings_as_source', to='compliance.requirement', verbose_name='Exigence source')),
                ('target_requirement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mappings_as_target', to='compliance.requirement', verbose_name='Exigence cible')),
            ],
            options={
                'verbose_name': 'Mapping inter-référentiels',
                'verbose_name_plural': 'Mappings inter-référentiels',
                'ordering': ['-created_at'],
                'constraints': [models.UniqueConstraint(fields=('source_requirement', 'target_requirement'), name='unique_requirement_mapping')],
            },
        ),
        migrations.AddConstraint(
            model_name='section',
            constraint=models.UniqueConstraint(fields=('framework', 'reference'), name='unique_section_reference_per_framework'),
        ),
        migrations.AddConstraint(
            model_name='requirement',
            constraint=models.UniqueConstraint(fields=('framework', 'reference'), name='unique_requirement_reference_per_framework'),
        ),
    ]
